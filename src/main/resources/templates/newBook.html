<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <title>New Book</title>
</head>
<body>
<div class="container-fluid text-center">

  <h1>New Book</h1>

  <div class="alert alert-success" th:if="${success}">
    <span th:text="${successMessage}"></span>
  </div>
  <div class="alert alert-danger" th:if="${success == false}">
    <span th:text="${errorMessage}"></span>
  </div>

  <form method="post" action="#" th:action="@{/Books/newSubmit}" th:object="${bookModel}">

    <input type="hidden" name="id" th:field="*{id}">

    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="BookName">Name</label>
      <input type="text" class="form-control" id="BookName" th:field="*{name}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="Language">Language</label>
      <input type="text" class="form-control" id="Language" th:field="*{language}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="ISBN">ISBN</label>
      <input type="text" class="form-control" id="ISBN" th:field="*{ISBN}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="PublicationYear">Publication Year</label>
      <input type="number" min="0" max="3000" class="form-control" id="PublicationYear" th:field="*{publication_year}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="Category">Category</label>
      <input type="text" class="form-control" id="Category" th:field="*{category}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="Genre">Genre</label>
      <input type="text" class="form-control" id="Genre" th:field="*{genre}">
    </div>

    <!-- Location -->
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="Stand">Stand</label>
      <input type="number" min="1" max="100" class="form-control" id="Stand" th:field="*{stand}">
    </div>
    <div class="mb-3 col-3 mx-auto">
      <label class="form-label" for="Shelf">Shelf</label>
      <input type="number" min="1" max="100" class="form-control" id="Shelf" th:field="*{shelf}">
    </div>

    <ul class="list-group" id="author-list">
      <li class="list-group-item mb-3 col-3 mx-auto" th:each="author, iterStat : ${bookModel.authors}">
        <!--<div class="mb-3 col-3 mx-auto">-->
          <label class="form-label" for="AuthorName">Author</label>
          <input type="text" class="form-control" id="AuthorName" name="authors[__${iterStat.index}__].name" th:value="${author.name}">
          <label class="form-label" for="AuthorSurname">Author</label>
        <input type="text" class="form-control" id="AuthorSurname" name="authors[__${iterStat.index}__].surname" th:value="${author.surname}">
          <label class="form-label" for="AuthorNationality">Author</label>
        <input type="text" class="form-control" id="AuthorNationality" name="authors[__${iterStat.index}__].nationality" th:value="${author.nationality}">
          <label class="form-label" for="AuthorCentury">Author</label>
        <input type="text" class="form-control" id="AuthorCentury" name="authors[__${iterStat.index}__].century" th:value="${author.century}">
          <button type="button" onclick="removeAuthor(this)">Remove</button>
        <!--</div>-->
      </li>
    </ul>
    <button type="button" onclick="addAuthor()">Add Name</button>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>

</div>

</body>
</html>

<script>
  function addAuthor() {
    var authorsList = document.getElementById("author-list");
    authorsList.className = "list-group"
    var newAuthor = document.createElement("li");
    newAuthor.className = "list-group-item mb-3 col-3 mx-auto";

    var nameLabel = document.createElement("label");
    nameLabel.className = "form-label";
    nameLabel.htmlFor = "AuthorName";
    nameLabel.innerHTML = "Name";
    var nameInput = document.createElement("input");
    nameInput.type = "text";
    nameInput.className = "form-control";
    nameInput.id = "AuthorName"
    nameInput.name = "authors[].name";

    var surnameLabel = document.createElement("label");
    surnameLabel.className = "form-label";
    surnameLabel.htmlFor = "AuthorSurname";
    surnameLabel.innerHTML = "Surname";
    var surnameInput = document.createElement("input");
    surnameInput.type = "text";
    surnameInput.className = "form-control";
    nameInput.id = "AuthorSurname"
    surnameInput.name = "authors[].surname";

    var nationalityLabel = document.createElement("label");
    nationalityLabel.className = "form-label";
    nationalityLabel.htmlFor = "AuthorNationality";
    nationalityLabel.innerHTML = "Nationality";
    var nationalityInput = document.createElement("input");
    nationalityInput.type = "text";
    nationalityInput.className = "form-control";
    nameInput.id = "AuthorNationality"
    nationalityInput.name = "authors[].nationality";

    var centuryLabel = document.createElement("label");
    centuryLabel.className = "form-label";
    centuryLabel.htmlFor = "AuthorCentury";
    centuryLabel.innerHTML = "Century";
    var centuryInput = document.createElement("input");
    centuryInput.type = "number";
    centuryInput.className = "form-control";
    nameInput.id = "AuthorCentury"
    centuryInput.name = "authors[].century";

    var removeButton = document.createElement("button");
    removeButton.type = "button";
    removeButton.innerHTML = "Remove";
    removeButton.onclick = function() {
      removeAuthor(this);
    };

    newAuthor.appendChild(nameLabel);
    newAuthor.appendChild(nameInput);
    newAuthor.appendChild(surnameLabel);
    newAuthor.appendChild(surnameInput);
    newAuthor.appendChild(nationalityLabel);
    newAuthor.appendChild(nationalityInput);
    newAuthor.appendChild(centuryLabel);
    newAuthor.appendChild(centuryInput);
    newAuthor.appendChild(removeButton);
    authorsList.appendChild(newAuthor);
  }

  function removeAuthor(button) {
    var authorToRemove = button.parentNode;
    var authorsList = authorToRemove.parentNode;
    authorsList.removeChild(authorToRemove);
  }
</script>

